clear all
close all
clc

%% ----------------- Color spectrum generation -------------------
%Used spectrum = AM1.5G, 1000 W/m2
Sp = [280,4.73090000000000e-23;280.500000000000,1.23070000000000e-21;281,5.68950000000000e-21;281.500000000000,1.56620000000000e-19;282,1.19460000000000e-18;282.500000000000,4.54360000000000e-18;283,1.84520000000000e-17;283.500000000000,3.53600000000000e-17;284,7.26700000000000e-16;284.500000000000,2.48560000000000e-15;285,8.01420000000000e-15;285.500000000000,4.26130000000000e-14;286,1.36840000000000e-13;286.500000000000,8.38230000000000e-13;287,2.73670000000000e-12;287.500000000000,1.09030000000000e-11;288,6.23370000000000e-11;288.500000000000,1.71620000000000e-10;289,5.62650000000000e-10;289.500000000000,2.07490000000000e-09;290,6.01680000000000e-09;290.500000000000,1.37830000000000e-08;291,3.50520000000000e-08;291.500000000000,1.09130000000000e-07;292,2.68300000000000e-07;292.500000000000,4.26850000000000e-07;293,8.64660000000000e-07;293.500000000000,2.27070000000000e-06;294,4.17440000000000e-06;294.500000000000,6.59110000000000e-06;295,1.22900000000000e-05;295.500000000000,2.78260000000000e-05;296,4.79040000000000e-05;296.500000000000,7.13450000000000e-05;297,9.68000000000000e-05;297.500000000000,0.000186080000000000;298,0.000289880000000000;298.500000000000,0.000357890000000000;299,0.000492110000000000;299.500000000000,0.000860680000000000;300,0.00102050000000000;300.500000000000,0.00124500000000000;301,0.00193000000000000;301.500000000000,0.00269140000000000;302,0.00292090000000000;302.500000000000,0.00428400000000000;303,0.00709450000000000;303.500000000000,0.00897950000000000;304,0.00947010000000000;304.500000000000,0.0119530000000000;305,0.0164630000000000;305.500000000000,0.0187190000000000;306,0.0185770000000000;306.500000000000,0.0211080000000000;307,0.0278490000000000;307.500000000000,0.0356350000000000;308,0.0378370000000000;308.500000000000,0.0414300000000000;309,0.0405340000000000;309.500000000000,0.0433060000000000;310,0.0509390000000000;310.500000000000,0.0655400000000000;311,0.0829220000000000;311.500000000000,0.0840800000000000;312,0.0933760000000000;312.500000000000,0.0989840000000000;313,0.107330000000000;313.500000000000,0.107570000000000;314,0.119690000000000;314.500000000000,0.130600000000000;315,0.136250000000000;315.500000000000,0.118380000000000;316,0.123480000000000;316.500000000000,0.150360000000000;317,0.171580000000000;317.500000000000,0.182450000000000;318,0.175940000000000;318.500000000000,0.185910000000000;319,0.204700000000000;319.500000000000,0.195890000000000;320,0.205270000000000;320.500000000000,0.245250000000000;321,0.250240000000000;321.500000000000,0.238430000000000;322,0.222030000000000;322.500000000000,0.217090000000000;323,0.212260000000000;323.500000000000,0.248610000000000;324,0.275370000000000;324.500000000000,0.283210000000000;325,0.278940000000000;325.500000000000,0.324360000000000;326,0.381200000000000;326.500000000000,0.407220000000000;327,0.398060000000000;327.500000000000,0.384650000000000;328,0.351160000000000;328.500000000000,0.371640000000000;329,0.422350000000000;329.500000000000,0.468780000000000;330,0.471390000000000;330.500000000000,0.428000000000000;331,0.402620000000000;331.500000000000,0.418060000000000;332,0.436230000000000;332.500000000000,0.439190000000000;333,0.429440000000000;333.500000000000,0.407240000000000;334,0.414970000000000;334.500000000000,0.445090000000000;335,0.463880000000000;335.500000000000,0.453130000000000;336,0.415190000000000;336.500000000000,0.382140000000000;337,0.373800000000000;337.500000000000,0.400510000000000;338,0.434110000000000;338.500000000000,0.455270000000000;339,0.463550000000000;339.500000000000,0.474460000000000;340,0.501800000000000;340.500000000000,0.500710000000000;341,0.471390000000000;341.500000000000,0.469350000000000;342,0.489340000000000;342.500000000000,0.507670000000000;343,0.514890000000000;343.500000000000,0.486090000000000;344,0.418430000000000;344.500000000000,0.403070000000000;345,0.458980000000000;345.500000000000,0.489320000000000;346,0.477780000000000;346.500000000000,0.486570000000000;347,0.494040000000000;347.500000000000,0.476740000000000;348,0.475110000000000;348.500000000000,0.483360000000000;349,0.465640000000000;349.500000000000,0.478050000000000;350,0.527980000000000;350.500000000000,0.567410000000000;351,0.551720000000000;351.500000000000,0.530220000000000;352,0.517910000000000;352.500000000000,0.489620000000000;353,0.520400000000000;353.500000000000,0.572280000000000;354,0.604980000000000;354.500000000000,0.611560000000000;355,0.611400000000000;355.500000000000,0.590280000000000;356,0.553870000000000;356.500000000000,0.519420000000000;357,0.456730000000000;357.500000000000,0.462150000000000;358,0.430060000000000;358.500000000000,0.399260000000000;359,0.469530000000000;359.500000000000,0.565490000000000;360,0.598170000000000;360.500000000000,0.565310000000000;361,0.520240000000000;361.500000000000,0.509560000000000;362,0.534200000000000;362.500000000000,0.585100000000000;363,0.601910000000000;363.500000000000,0.585410000000000;364,0.606280000000000;364.500000000000,0.600580000000000;365,0.623590000000000;365.500000000000,0.686280000000000;366,0.735320000000000;366.500000000000,0.736580000000000;367,0.722850000000000;367.500000000000,0.709140000000000;368,0.667590000000000;368.500000000000,0.663100000000000;369,0.693150000000000;369.500000000000,0.744690000000000;370,0.755070000000000;370.500000000000,0.682610000000000;371,0.693380000000000;371.500000000000,0.720510000000000;372,0.674440000000000;372.500000000000,0.642530000000000;373,0.618860000000000;373.500000000000,0.557860000000000;374,0.556400000000000;374.500000000000,0.552270000000000;375,0.589300000000000;375.500000000000,0.651620000000000;376,0.674800000000000;376.500000000000,0.663900000000000;377,0.712250000000000;377.500000000000,0.794550000000000;378,0.855950000000000;378.500000000000,0.834180000000000;379,0.743890000000000;379.500000000000,0.666830000000000;380,0.700770000000000;380.500000000000,0.750750000000000;381,0.763830000000000;381.500000000000,0.688370000000000;382,0.586780000000000;382.500000000000,0.507620000000000;383,0.454990000000000;383.500000000000,0.440490000000000;384,0.509680000000000;384.500000000000,0.613590000000000;385,0.673550000000000;385.500000000000,0.643630000000000;386,0.621000000000000;386.500000000000,0.645700000000000;387,0.651470000000000;387.500000000000,0.642040000000000;388,0.635820000000000;388.500000000000,0.631360000000000;389,0.685430000000000;389.500000000000,0.759700000000000;390,0.796990000000000;390.500000000000,0.803710000000000;391,0.851380000000000;391.500000000000,0.863440000000000;392,0.794930000000000;392.500000000000,0.662570000000000;393,0.479750000000000;393.500000000000,0.381520000000000;394,0.495670000000000;394.500000000000,0.683850000000000;395,0.807720000000000;395.500000000000,0.860380000000000;396,0.756550000000000;396.500000000000,0.550170000000000;397,0.426190000000000;397.500000000000,0.629450000000000;398,0.852490000000000;398.500000000000,1.00690000000000;399,1.06930000000000;399.500000000000,1.10210000000000;400,1.11410000000000;401,1.16030000000000;402,1.20610000000000;403,1.16130000000000;404,1.18010000000000;405,1.15110000000000;406,1.12270000000000;407,1.10260000000000;408,1.15140000000000;409,1.22990000000000;410,1.04850000000000;411,1.17380000000000;412,1.24780000000000;413,1.19710000000000;414,1.18420000000000;415,1.22580000000000;416,1.26240000000000;417,1.23120000000000;418,1.17770000000000;419,1.22580000000000;420,1.12320000000000;421,1.27570000000000;422,1.25830000000000;423,1.21840000000000;424,1.21170000000000;425,1.24880000000000;426,1.21350000000000;427,1.17240000000000;428,1.18390000000000;429,1.09630000000000;430,0.874620000000000;431,0.793940000000000;432,1.32070000000000;433,1.22880000000000;434,1.13520000000000;435,1.24520000000000;436,1.36590000000000;437,1.39430000000000;438,1.22380000000000;439,1.17750000000000;440,1.34990000000000;441,1.33130000000000;442,1.42500000000000;443,1.44530000000000;444,1.40840000000000;445,1.46190000000000;446,1.31080000000000;447,1.49030000000000;448,1.50810000000000;449,1.50450000000000;450,1.55950000000000;451,1.61730000000000;452,1.54820000000000;453,1.42970000000000;454,1.53350000000000;455,1.52240000000000;456,1.57240000000000;457,1.58540000000000;458,1.55140000000000;459,1.53910000000000;460,1.52910000000000;461,1.58270000000000;462,1.59750000000000;463,1.60310000000000;464,1.55440000000000;465,1.53500000000000;466,1.56730000000000;467,1.49730000000000;468,1.56190000000000;469,1.56820000000000;470,1.50770000000000;471,1.53310000000000;472,1.61260000000000;473,1.54990000000000;474,1.56710000000000;475,1.61850000000000;476,1.56310000000000;477,1.57240000000000;478,1.62300000000000;479,1.59160000000000;480,1.61810000000000;481,1.61770000000000;482,1.62360000000000;483,1.60380000000000;484,1.57340000000000;485,1.56830000000000;486,1.27160000000000;487,1.42410000000000;488,1.54130000000000;489,1.45190000000000;490,1.62240000000000;491,1.55950000000000;492,1.48690000000000;493,1.59030000000000;494,1.55250000000000;495,1.64850000000000;496,1.56760000000000;497,1.59440000000000;498,1.55090000000000;499,1.55070000000000;500,1.54510000000000;501,1.49780000000000;502,1.49660000000000;503,1.56530000000000;504,1.45870000000000;505,1.56350000000000;506,1.62640000000000;507,1.55600000000000;508,1.51650000000000;509,1.58930000000000;510,1.54810000000000;511,1.57690000000000;512,1.61860000000000;513,1.52060000000000;514,1.48850000000000;515,1.53140000000000;516,1.54550000000000;517,1.25940000000000;518,1.44030000000000;519,1.39570000000000;520,1.52360000000000;521,1.53460000000000;522,1.56900000000000;523,1.47890000000000;524,1.59050000000000;525,1.57810000000000;526,1.53410000000000;527,1.34170000000000;528,1.53570000000000;529,1.60710000000000;530,1.54460000000000;531,1.62920000000000;532,1.59980000000000;533,1.42860000000000;534,1.53020000000000;535,1.55350000000000;536,1.61990000000000;537,1.49890000000000;538,1.57380000000000;539,1.53520000000000;540,1.48250000000000;541,1.42510000000000;542,1.55110000000000;543,1.52560000000000;544,1.57920000000000;545,1.54350000000000;546,1.52910000000000;547,1.54900000000000;548,1.50490000000000;549,1.55200000000000;550,1.53990000000000;551,1.53820000000000;552,1.56970000000000;553,1.52500000000000;554,1.55490000000000;555,1.56340000000000;556,1.53660000000000;557,1.49880000000000;558,1.53100000000000;559,1.44830000000000;560,1.47400000000000;561,1.55950000000000;562,1.48470000000000;563,1.54080000000000;564,1.51060000000000;565,1.52010000000000;566,1.43740000000000;567,1.53200000000000;568,1.51800000000000;569,1.48070000000000;570,1.48160000000000;571,1.43310000000000;572,1.51340000000000;573,1.51980000000000;574,1.51190000000000;575,1.47770000000000;576,1.46540000000000;577,1.50230000000000;578,1.45600000000000;579,1.47700000000000;580,1.50200000000000;581,1.50890000000000;582,1.53200000000000;583,1.54790000000000;584,1.54480000000000;585,1.53240000000000;586,1.49530000000000;587,1.52810000000000;588,1.49340000000000;589,1.28940000000000;590,1.37090000000000;591,1.46620000000000;592,1.43540000000000;593,1.45610000000000;594,1.44910000000000;595,1.43080000000000;596,1.47450000000000;597,1.47880000000000;598,1.46070000000000;599,1.46060000000000;600,1.47530000000000;601,1.45790000000000;602,1.43600000000000;603,1.46640000000000;604,1.49210000000000;605,1.48950000000000;606,1.48220000000000;607,1.49110000000000;608,1.48620000000000;609,1.47490000000000;610,1.46860000000000;611,1.46110000000000;612,1.48310000000000;613,1.46210000000000;614,1.41760000000000;615,1.46970000000000;616,1.43100000000000;617,1.41280000000000;618,1.46640000000000;619,1.47330000000000;620,1.47390000000000;621,1.48020000000000;622,1.42690000000000;623,1.41650000000000;624,1.41180000000000;625,1.40260000000000;626,1.40120000000000;627,1.44170000000000;628,1.36310000000000;629,1.41140000000000;630,1.39240000000000;631,1.41610000000000;632,1.36380000000000;633,1.45080000000000;634,1.42840000000000;635,1.44580000000000;636,1.41280000000000;637,1.46100000000000;638,1.47070000000000;639,1.46460000000000;640,1.43400000000000;641,1.43480000000000;642,1.43760000000000;643,1.45250000000000;644,1.44620000000000;645,1.45670000000000;646,1.41500000000000;647,1.40860000000000;648,1.39520000000000;649,1.35190000000000;650,1.35940000000000;651,1.44470000000000;652,1.38710000000000;653,1.43110000000000;654,1.41530000000000;655,1.34990000000000;656,1.18510000000000;657,1.23930000000000;658,1.38550000000000;659,1.39050000000000;660,1.39920000000000;661,1.39330000000000;662,1.38190000000000;663,1.38440000000000;664,1.39670000000000;665,1.42140000000000;666,1.42030000000000;667,1.41020000000000;668,1.41500000000000;669,1.43940000000000;670,1.41960000000000;671,1.41690000000000;672,1.39720000000000;673,1.40940000000000;674,1.40740000000000;675,1.39580000000000;676,1.41200000000000;677,1.39910000000000;678,1.40660000000000;679,1.39470000000000;680,1.39690000000000;681,1.39150000000000;682,1.39810000000000;683,1.38300000000000;684,1.37390000000000;685,1.37480000000000;686,1.34380000000000;687,0.968240000000000;688,1.12060000000000;689,1.12780000000000;690,1.18210000000000;691,1.23330000000000;692,1.26890000000000;693,1.26090000000000;694,1.24640000000000;695,1.27140000000000;696,1.26840000000000;697,1.34030000000000;698,1.31920000000000;699,1.29180000000000;700,1.28230000000000;701,1.26590000000000;702,1.26740000000000;703,1.27470000000000;704,1.30780000000000;705,1.32140000000000;706,1.31440000000000;707,1.30900000000000;708,1.30480000000000;709,1.30950000000000;710,1.31750000000000;711,1.31550000000000;712,1.30710000000000;713,1.29180000000000;714,1.30290000000000;715,1.25870000000000;716,1.27160000000000;717,1.10710000000000;718,1.02960000000000;719,0.923180000000000;720,0.985500000000000;721,1.08610000000000;722,1.24070000000000;723,1.14440000000000;724,1.05550000000000;725,1.03800000000000;726,1.08130000000000;727,1.08500000000000;728,1.04000000000000;729,1.04660000000000;730,1.12850000000000;731,1.07030000000000;732,1.15340000000000;733,1.19620000000000;734,1.23570000000000;735,1.21780000000000;736,1.20590000000000;737,1.20390000000000;738,1.22690000000000;739,1.19050000000000;740,1.21950000000000;741,1.21480000000000;742,1.21530000000000;743,1.24050000000000;744,1.25030000000000;745,1.24970000000000;746,1.24700000000000;747,1.24770000000000;748,1.24010000000000;749,1.23570000000000;750,1.23410000000000;751,1.22860000000000;752,1.23300000000000;753,1.22660000000000;754,1.24200000000000;755,1.23830000000000;756,1.22320000000000;757,1.22210000000000;758,1.22950000000000;759,1.19450000000000;760,0.266040000000000;761,0.153960000000000;762,0.687660000000000;763,0.379520000000000;764,0.538780000000000;765,0.686010000000000;766,0.814610000000000;767,0.974170000000000;768,1.11380000000000;769,1.12780000000000;770,1.16080000000000;771,1.16860000000000;772,1.17780000000000;773,1.17710000000000;774,1.17710000000000;775,1.17710000000000;776,1.17980000000000;777,1.17270000000000;778,1.17130000000000;779,1.17650000000000;780,1.16360000000000;781,1.16070000000000;782,1.16620000000000;783,1.16140000000000;784,1.15360000000000;785,1.15860000000000;786,1.15920000000000;787,1.14500000000000;788,1.13050000000000;789,1.12570000000000;790,1.09100000000000;791,1.10580000000000;792,1.09530000000000;793,1.08750000000000;794,1.09720000000000;795,1.09320000000000;796,1.07420000000000;797,1.09130000000000;798,1.11210000000000;799,1.09050000000000;800,1.07250000000000;801,1.08430000000000;802,1.08560000000000;803,1.06570000000000;804,1.07820000000000;805,1.05450000000000;806,1.09740000000000;807,1.08590000000000;808,1.08210000000000;809,1.05480000000000;810,1.05590000000000;811,1.05330000000000;812,1.02680000000000;813,1.00860000000000;814,0.903560000000000;815,0.895230000000000;816,0.832160000000000;817,0.851830000000000;818,0.822590000000000;819,0.905190000000000;820,0.861880000000000;821,0.997640000000000;822,0.951570000000000;823,0.672710000000000;824,0.935060000000000;825,0.969350000000000;826,0.933810000000000;827,0.984650000000000;828,0.849790000000000;829,0.929300000000000;830,0.916010000000000;831,0.923920000000000;832,0.894260000000000;833,0.956500000000000;834,0.934120000000000;835,1.00320000000000;836,0.972340000000000;837,1.00920000000000;838,0.999010000000000;839,1.00130000000000;840,1.01570000000000;841,1.01010000000000;842,0.997030000000000;843,1.00530000000000;844,0.986310000000000;845,1.01650000000000;846,1.01870000000000;847,0.991700000000000;848,0.992170000000000;849,0.985960000000000;850,0.893720000000000;851,0.974930000000000;852,0.969270000000000;853,0.964860000000000;854,0.851120000000000;855,0.913000000000000;856,0.973170000000000;857,0.991660000000000;858,0.991960000000000;859,0.991710000000000;860,0.988160000000000;861,0.986790000000000;862,0.994490000000000;863,1.00050000000000;864,0.979160000000000;865,0.963240000000000;866,0.849000000000000;867,0.915460000000000;868,0.959200000000000;869,0.949560000000000;870,0.967550000000000;871,0.953870000000000;872,0.966860000000000;873,0.957210000000000;874,0.940420000000000;875,0.926870000000000;876,0.952770000000000;877,0.956150000000000;878,0.952370000000000;879,0.936560000000000;880,0.939570000000000;881,0.908610000000000;882,0.932450000000000;883,0.929270000000000;884,0.933050000000000;885,0.944230000000000;886,0.907520000000000;887,0.910620000000000;888,0.922280000000000;889,0.934550000000000;890,0.923930000000000;891,0.925840000000000;892,0.908810000000000;893,0.873270000000000;894,0.851300000000000;895,0.813570000000000;896,0.762530000000000;897,0.665660000000000;898,0.717800000000000;899,0.548710000000000;900,0.742600000000000;901,0.599330000000000;902,0.667910000000000;903,0.688890000000000;904,0.844570000000000;905,0.817090000000000;906,0.775580000000000;907,0.638540000000000;908,0.652170000000000;909,0.704310000000000;910,0.624670000000000;911,0.668080000000000;912,0.688930000000000;913,0.628340000000000;914,0.626490000000000;915,0.678360000000000;916,0.576460000000000;917,0.730170000000000;918,0.592710000000000;919,0.738770000000000;920,0.744140000000000;921,0.780490000000000;922,0.700260000000000;923,0.745040000000000;924,0.721500000000000;925,0.711100000000000;926,0.703310000000000;927,0.787420000000000;928,0.589680000000000;929,0.551270000000000;930,0.432100000000000;931,0.409210000000000;932,0.300860000000000;933,0.248410000000000;934,0.143800000000000;935,0.250840000000000;936,0.161420000000000;937,0.163380000000000;938,0.200580000000000;939,0.398870000000000;940,0.471810000000000;941,0.371950000000000;942,0.405320000000000;943,0.278340000000000;944,0.285790000000000;945,0.368210000000000;946,0.194610000000000;947,0.371120000000000;948,0.274230000000000;949,0.493960000000000;950,0.147260000000000;951,0.483780000000000;952,0.268910000000000;953,0.343620000000000;954,0.424110000000000;955,0.341170000000000;956,0.328210000000000;957,0.270670000000000;958,0.461010000000000;959,0.373850000000000;960,0.420660000000000;961,0.461200000000000;962,0.441740000000000;963,0.505030000000000;964,0.458600000000000;965,0.503740000000000;966,0.502750000000000;967,0.502400000000000;968,0.652100000000000;969,0.686220000000000;970,0.634610000000000;971,0.713970000000000;972,0.687650000000000;973,0.606480000000000;974,0.575290000000000;975,0.589870000000000;976,0.571910000000000;977,0.638640000000000;978,0.615090000000000;979,0.638150000000000;980,0.604680000000000;981,0.713380000000000;982,0.692180000000000;983,0.668650000000000;984,0.737320000000000;985,0.688170000000000;986,0.750830000000000;987,0.739280000000000;988,0.734620000000000;989,0.749060000000000;990,0.732270000000000;991,0.753580000000000;992,0.751020000000000;993,0.737280000000000;994,0.754100000000000;995,0.751760000000000;996,0.748840000000000;997,0.739710000000000;998,0.738870000000000;999,0.738570000000000;1000,0.735320000000000;1001,0.744420000000000;1002,0.728050000000000;1003,0.734420000000000;1004,0.723360000000000;1005,0.681740000000000;1006,0.712520000000000;1007,0.727530000000000;1008,0.726850000000000;1009,0.719720000000000;1010,0.719140000000000;1011,0.722780000000000;1012,0.718770000000000;1013,0.717610000000000;1014,0.720680000000000;1015,0.708170000000000;1016,0.711290000000000;1017,0.703370000000000;1018,0.714220000000000;1019,0.688780000000000;1020,0.698960000000000;1021,0.701750000000000;1022,0.689700000000000;1023,0.695080000000000;1024,0.690580000000000;1025,0.697530000000000;1026,0.696360000000000;1027,0.693050000000000;1028,0.693850000000000;1029,0.686280000000000;1030,0.690550000000000;1031,0.687360000000000;1032,0.687870000000000;1033,0.676130000000000;1034,0.680150000000000;1035,0.682340000000000;1036,0.682020000000000;1037,0.674970000000000;1038,0.671720000000000;1039,0.676360000000000;1040,0.671700000000000;1041,0.671760000000000;1042,0.672000000000000;1043,0.665250000000000;1044,0.668330000000000;1045,0.664520000000000;1046,0.647140000000000;1047,0.656940000000000;1048,0.662740000000000;1049,0.658960000000000;1050,0.654630000000000;1051,0.655210000000000;1052,0.651180000000000;1053,0.649190000000000;1054,0.646460000000000;1055,0.648470000000000;1056,0.646410000000000;1057,0.644820000000000;1058,0.638180000000000;1059,0.618750000000000;1060,0.635850000000000;1061,0.621210000000000;1062,0.632660000000000;1063,0.622390000000000;1064,0.631960000000000;1065,0.629130000000000;1066,0.617130000000000;1067,0.620320000000000;1068,0.619440000000000;1069,0.586260000000000;1070,0.604690000000000;1071,0.616610000000000;1072,0.615360000000000;1073,0.603630000000000;1074,0.621580000000000;1075,0.592520000000000;1076,0.614710000000000;1077,0.604340000000000;1078,0.603210000000000;1079,0.604740000000000;1080,0.597220000000000;1081,0.580830000000000;1082,0.589400000000000;1083,0.598140000000000;1084,0.578520000000000;1085,0.593300000000000;1086,0.554100000000000;1087,0.566970000000000;1088,0.593170000000000;1089,0.579190000000000;1090,0.555730000000000;1091,0.588350000000000;1092,0.581240000000000;1093,0.510580000000000;1094,0.539650000000000;1095,0.520670000000000;1096,0.503230000000000;1097,0.578520000000000;1098,0.502910000000000;1099,0.507720000000000;1100,0.485770000000000;1101,0.496960000000000;1102,0.468830000000000;1103,0.466370000000000;1104,0.467650000000000;1105,0.506440000000000;1106,0.397920000000000;1107,0.483040000000000;1108,0.415650000000000;1109,0.412780000000000;1110,0.478990000000000;1111,0.331540000000000;1112,0.413570000000000;1113,0.268500000000000;1114,0.299850000000000;1115,0.249870000000000;1116,0.201360000000000;1117,0.0796180000000000;1118,0.217530000000000;1119,0.113170000000000;1120,0.141890000000000;1121,0.185860000000000;1122,0.0816860000000000;1123,0.128170000000000;1124,0.108700000000000;1125,0.144280000000000;1126,0.0515890000000000;1127,0.157250000000000;1128,0.0992240000000000;1129,0.105910000000000;1130,0.0705740000000000;1131,0.295600000000000;1132,0.234110000000000;1133,0.153310000000000;1134,0.0417400000000000;1135,0.0154620000000000;1136,0.128760000000000;1137,0.287850000000000;1138,0.203290000000000;1139,0.298500000000000;1140,0.255990000000000;1141,0.193370000000000;1142,0.224790000000000;1143,0.311830000000000;1144,0.113260000000000;1145,0.146040000000000;1146,0.157640000000000;1147,0.0591760000000000;1148,0.271130000000000;1149,0.218540000000000;1150,0.121640000000000;1151,0.203400000000000;1152,0.247620000000000;1153,0.238120000000000;1154,0.142480000000000;1155,0.313160000000000;1156,0.280900000000000;1157,0.314580000000000;1158,0.311710000000000;1159,0.336930000000000;1160,0.286480000000000;1161,0.347530000000000;1162,0.350020000000000;1163,0.468570000000000;1164,0.401880000000000;1165,0.388600000000000;1166,0.374940000000000;1167,0.409960000000000;1168,0.419540000000000;1169,0.423100000000000;1170,0.458730000000000;1171,0.448310000000000;1172,0.454830000000000;1173,0.456420000000000;1174,0.336920000000000;1175,0.452400000000000;1176,0.476790000000000;1177,0.472350000000000;1178,0.360000000000000;1179,0.483710000000000;1180,0.440690000000000;1181,0.455140000000000;1182,0.323180000000000;1183,0.438700000000000;1184,0.419850000000000;1185,0.407410000000000;1186,0.477150000000000;1187,0.455750000000000;1188,0.335040000000000;1189,0.415690000000000;1190,0.462390000000000;1191,0.446600000000000;1192,0.473360000000000;1193,0.454340000000000;1194,0.468900000000000;1195,0.446960000000000;1196,0.431310000000000;1197,0.477150000000000;1198,0.433920000000000;1199,0.364890000000000;1200,0.448250000000000;1201,0.437080000000000;1202,0.437170000000000;1203,0.434090000000000;1204,0.362470000000000;1205,0.436920000000000;1206,0.480860000000000;1207,0.429860000000000;1208,0.433460000000000;1209,0.414280000000000;1210,0.453360000000000;1211,0.422320000000000;1212,0.424890000000000;1213,0.469560000000000;1214,0.434070000000000;1215,0.427800000000000;1216,0.466400000000000;1217,0.455280000000000;1218,0.459340000000000;1219,0.446630000000000;1220,0.458050000000000;1221,0.465310000000000;1222,0.451390000000000;1223,0.444060000000000;1224,0.448080000000000;1225,0.462360000000000;1226,0.468190000000000;1227,0.433040000000000;1228,0.466580000000000;1229,0.467210000000000;1230,0.460030000000000;1231,0.472030000000000;1232,0.466330000000000;1233,0.453970000000000;1234,0.470160000000000;1235,0.465040000000000;1236,0.469080000000000;1237,0.463390000000000;1238,0.467970000000000;1239,0.462720000000000;1240,0.460770000000000;1241,0.461970000000000;1242,0.462470000000000;1243,0.457540000000000;1244,0.455280000000000;1245,0.456550000000000;1246,0.459450000000000;1247,0.457460000000000;1248,0.458600000000000;1249,0.459660000000000;1250,0.457050000000000;1251,0.452580000000000;1252,0.450970000000000;1253,0.447730000000000;1254,0.443630000000000;1255,0.450700000000000;1256,0.440230000000000;1257,0.435320000000000;1258,0.444960000000000;1259,0.427250000000000;1260,0.431100000000000;1261,0.411460000000000;1262,0.395670000000000;1263,0.400190000000000;1264,0.371480000000000;1265,0.395700000000000;1266,0.385270000000000;1267,0.388220000000000;1268,0.370510000000000;1269,0.246520000000000;1270,0.387440000000000;1271,0.408250000000000;1272,0.408790000000000;1273,0.406250000000000;1274,0.406140000000000;1275,0.412330000000000;1276,0.416930000000000;1277,0.420010000000000;1278,0.427630000000000;1279,0.424560000000000;1280,0.422040000000000;1281,0.413350000000000;1282,0.373050000000000;1283,0.407330000000000;1284,0.420780000000000;1285,0.423990000000000;1286,0.427140000000000;1287,0.422130000000000;1288,0.419890000000000;1289,0.409360000000000;1290,0.412850000000000;1291,0.417860000000000;1292,0.396180000000000;1293,0.412570000000000;1294,0.404210000000000;1295,0.405140000000000;1296,0.389570000000000;1297,0.371300000000000;1298,0.391830000000000;1299,0.408520000000000;1300,0.353120000000000;1301,0.362280000000000;1302,0.391810000000000;1303,0.346210000000000;1304,0.300620000000000;1305,0.383820000000000;1306,0.384530000000000;1307,0.305940000000000;1308,0.346960000000000;1309,0.384130000000000;1310,0.301140000000000;1311,0.333660000000000;1312,0.333370000000000;1313,0.313520000000000;1314,0.288330000000000;1315,0.285810000000000;1316,0.324190000000000;1317,0.312170000000000;1318,0.333280000000000;1319,0.268550000000000;1320,0.258720000000000;1321,0.298660000000000;1322,0.302170000000000;1323,0.232790000000000;1324,0.262490000000000;1325,0.322240000000000;1326,0.280510000000000;1327,0.266250000000000;1328,0.234500000000000;1329,0.177590000000000;1330,0.229230000000000;1331,0.144800000000000;1332,0.145790000000000;1333,0.203040000000000;1334,0.169250000000000;1335,0.231170000000000;1336,0.183480000000000;1337,0.164540000000000;1338,0.178040000000000;1339,0.176810000000000;1340,0.168310000000000;1341,0.170390000000000;1342,0.177980000000000;1343,0.127110000000000;1344,0.0756450000000000;1345,0.109040000000000;1346,0.0581860000000000;1347,0.0601190000000000;1348,0.00474510000000000;1349,0.0161590000000000;1350,0.0160250000000000;1351,0.00462980000000000;1352,0.00151640000000000;1353,9.60960000000000e-05;1354,0.000290090000000000;1355,3.60340000000000e-06;1356,4.80700000000000e-05;1357,7.17860000000000e-05;1358,4.19480000000000e-06;1359,7.34390000000000e-07;1360,2.14040000000000e-06;1361,4.81330000000000e-09;1362,1.80760000000000e-11;1363,3.15630000000000e-06;1364,1.35890000000000e-06;1365,9.07640000000000e-12;1366,1.27910000000000e-05;1367,4.97640000000000e-06;1368,1.48100000000000e-13;1369,5.16670000000000e-07;1370,2.92000000000000e-07;1371,1.97310000000000e-08;1372,2.74980000000000e-06;1373,4.44010000000000e-05;1374,0.000179170000000000;1375,0.000323320000000000;1376,0.000257480000000000;1377,0.000122700000000000;1378,0.00110890000000000;1379,5.21640000000000e-05;1380,8.15870000000000e-05;1381,2.37160000000000e-06;1382,2.56720000000000e-06;1383,4.40170000000000e-08;1384,6.16890000000000e-07;1385,2.08990000000000e-06;1386,2.52150000000000e-06;1387,0.000198960000000000;1388,4.02620000000000e-06;1389,0.000580980000000000;1390,0.000493280000000000;1391,0.000343840000000000;1392,2.37820000000000e-05;1393,0.000115860000000000;1394,7.55260000000000e-05;1395,6.71360000000000e-07;1396,6.32150000000000e-09;1397,4.90570000000000e-05;1398,0.00127040000000000;1399,0.000812260000000000;1400,3.24660000000000e-09;1401,1.05280000000000e-08;1402,0.00183530000000000;1403,0.00238000000000000;1404,0.000738920000000000;1405,3.64440000000000e-07;1406,0.00204480000000000;1407,0.000174570000000000;1408,0.00164930000000000;1409,0.000619190000000000;1410,0.000466530000000000;1411,0.00211420000000000;1412,0.00263960000000000;1413,0.0233530000000000;1414,0.000363780000000000;1415,0.000183660000000000;1416,0.0355650000000000;1417,0.0117590000000000;1418,0.0135590000000000;1419,0.00214420000000000;1420,0.00827180000000000;1421,0.00916370000000000;1422,0.0463140000000000;1423,0.00921980000000000;1424,0.0169750000000000;1425,0.0258500000000000;1426,0.0277920000000000;1427,0.0495460000000000;1428,0.00455880000000000;1429,0.0380200000000000;1430,0.0616010000000000;1431,0.0501560000000000;1432,0.00251940000000000;1433,0.0358340000000000;1434,0.0209620000000000;1435,0.0214160000000000;1436,0.0383510000000000;1437,0.0298800000000000;1438,0.0132630000000000;1439,0.0510390000000000;1440,0.0396010000000000;1441,0.0318000000000000;1442,0.0363170000000000;1443,0.0450630000000000;1444,0.0617910000000000;1445,0.0497510000000000;1446,0.0230950000000000;1447,0.0362150000000000;1448,0.115690000000000;1449,0.102130000000000;1450,0.0274120000000000;1451,0.0112710000000000;1452,0.0623610000000000;1453,0.0819780000000000;1454,0.137590000000000;1455,0.0661500000000000;1456,0.0885090000000000;1457,0.117000000000000;1458,0.136430000000000;1459,0.163070000000000;1460,0.0854210000000000;1461,0.0902760000000000;1462,0.130600000000000;1463,0.0432250000000000;1464,0.151840000000000;1465,0.0933830000000000;1466,0.0651970000000000;1467,0.0360540000000000;1468,0.0769420000000000;1469,0.0948450000000000;1470,0.0496780000000000;1471,0.0178480000000000;1472,0.0467710000000000;1473,0.0701980000000000;1474,0.0973390000000000;1475,0.184630000000000;1476,0.0687780000000000;1477,0.0697360000000000;1478,0.0634800000000000;1479,0.120010000000000;1480,0.0606370000000000;1481,0.115290000000000;1482,0.0584900000000000;1483,0.148590000000000;1484,0.137470000000000;1485,0.125030000000000;1486,0.123400000000000;1487,0.0606290000000000;1488,0.0941800000000000;1489,0.189730000000000;1490,0.174780000000000;1491,0.197780000000000;1492,0.164410000000000;1493,0.181570000000000;1494,0.203670000000000;1495,0.182530000000000;1496,0.168520000000000;1497,0.228500000000000;1498,0.189680000000000;1499,0.217590000000000;1500,0.250610000000000;1501,0.265520000000000;1502,0.233560000000000;1503,0.184930000000000;1504,0.160290000000000;1505,0.184020000000000;1506,0.257730000000000;1507,0.255140000000000;1508,0.243020000000000;1509,0.186900000000000;1510,0.270520000000000;1511,0.264740000000000;1512,0.260680000000000;1513,0.242390000000000;1514,0.225710000000000;1515,0.265730000000000;1516,0.256830000000000;1517,0.249290000000000;1518,0.252110000000000;1519,0.244370000000000;1520,0.264500000000000;1521,0.275050000000000;1522,0.263780000000000;1523,0.280040000000000;1524,0.275390000000000;1525,0.258840000000000;1526,0.267450000000000;1527,0.262200000000000;1528,0.279280000000000;1529,0.272440000000000;1530,0.255220000000000;1531,0.269730000000000;1532,0.278390000000000;1533,0.277140000000000;1534,0.268920000000000;1535,0.266860000000000;1536,0.274640000000000;1537,0.273360000000000;1538,0.272020000000000;1539,0.272950000000000;1540,0.264910000000000;1541,0.269040000000000;1542,0.269270000000000;1543,0.272080000000000;1544,0.272100000000000;1545,0.277050000000000;1546,0.274810000000000;1547,0.273090000000000;1548,0.266750000000000;1549,0.273420000000000;1550,0.269900000000000;1551,0.270580000000000;1552,0.271820000000000;1553,0.271320000000000;1554,0.264740000000000;1555,0.267590000000000;1556,0.263100000000000;1557,0.270620000000000;1558,0.268480000000000;1559,0.268080000000000;1560,0.265680000000000;1561,0.270020000000000;1562,0.267560000000000;1563,0.266670000000000;1564,0.262640000000000;1565,0.267280000000000;1566,0.262450000000000;1567,0.263080000000000;1568,0.257220000000000;1569,0.254520000000000;1570,0.241750000000000;1571,0.235070000000000;1572,0.237750000000000;1573,0.234070000000000;1574,0.241450000000000;1575,0.239740000000000;1576,0.246780000000000;1577,0.216020000000000;1578,0.235160000000000;1579,0.236720000000000;1580,0.244640000000000;1581,0.248700000000000;1582,0.241950000000000;1583,0.247550000000000;1584,0.249040000000000;1585,0.258740000000000;1586,0.255690000000000;1587,0.253030000000000;1588,0.251070000000000;1589,0.232330000000000;1590,0.241790000000000;1591,0.241970000000000;1592,0.252250000000000;1593,0.258330000000000;1594,0.256240000000000;1595,0.258230000000000;1596,0.244520000000000;1597,0.246920000000000;1598,0.254210000000000;1599,0.242020000000000;1600,0.238100000000000;1601,0.223230000000000;1602,0.224130000000000;1603,0.223970000000000;1604,0.228420000000000;1605,0.236830000000000;1606,0.241400000000000;1607,0.232960000000000;1608,0.229900000000000;1609,0.227270000000000;1610,0.217600000000000;1611,0.226800000000000;1612,0.230760000000000;1613,0.237190000000000;1614,0.238380000000000;1615,0.241040000000000;1616,0.230500000000000;1617,0.234650000000000;1618,0.243520000000000;1619,0.241000000000000;1620,0.234490000000000;1621,0.234300000000000;1622,0.237540000000000;1623,0.242460000000000;1624,0.242690000000000;1625,0.237820000000000;1626,0.239710000000000;1627,0.240780000000000;1628,0.241260000000000;1629,0.241370000000000;1630,0.236510000000000;1631,0.238060000000000;1632,0.238210000000000;1633,0.232670000000000;1634,0.232820000000000;1635,0.233670000000000;1636,0.235390000000000;1637,0.227000000000000;1638,0.220070000000000;1639,0.220260000000000;1640,0.215110000000000;1641,0.219600000000000;1642,0.220820000000000;1643,0.215350000000000;1644,0.223550000000000;1645,0.218220000000000;1646,0.217490000000000;1647,0.227680000000000;1648,0.216550000000000;1649,0.218670000000000;1650,0.225260000000000;1651,0.208550000000000;1652,0.223730000000000;1653,0.222770000000000;1654,0.215830000000000;1655,0.222310000000000;1656,0.221010000000000;1657,0.222230000000000;1658,0.224870000000000;1659,0.221200000000000;1660,0.223320000000000;1661,0.223840000000000;1662,0.219080000000000;1663,0.222350000000000;1664,0.220980000000000;1665,0.211780000000000;1666,0.178840000000000;1667,0.210680000000000;1668,0.214590000000000;1669,0.215160000000000;1670,0.221680000000000;1671,0.218790000000000;1672,0.211470000000000;1673,0.216290000000000;1674,0.215750000000000;1675,0.213600000000000;1676,0.211450000000000;1677,0.212290000000000;1678,0.209150000000000;1679,0.213030000000000;1680,0.205580000000000;1681,0.194470000000000;1682,0.203660000000000;1683,0.209060000000000;1684,0.197970000000000;1685,0.213210000000000;1686,0.210260000000000;1687,0.204840000000000;1688,0.210130000000000;1689,0.207180000000000;1690,0.205230000000000;1691,0.193030000000000;1692,0.207080000000000;1693,0.211340000000000;1694,0.204770000000000;1695,0.209680000000000;1696,0.209220000000000;1697,0.181070000000000;1698,0.207390000000000;1699,0.205510000000000;1700,0.199750000000000;1702,0.203960000000000;1705,0.197780000000000;1710,0.187900000000000;1715,0.189650000000000;1720,0.186980000000000;1725,0.178080000000000;1730,0.174070000000000;1735,0.161540000000000;1740,0.168180000000000;1745,0.154810000000000;1750,0.165660000000000;1755,0.153010000000000;1760,0.159980000000000;1765,0.132840000000000;1770,0.141720000000000;1775,0.114840000000000;1780,0.100500000000000;1785,0.0769810000000000;1790,0.0889040000000000;1795,0.0469310000000000;1800,0.0318280000000000;1805,0.0148150000000000;1810,0.00969110000000000;1815,0.00328160000000000;1820,0.000987550000000000;1825,0.00127440000000000;1830,5.20410000000000e-06;1835,6.41900000000000e-06;1840,6.27030000000000e-08;1845,6.26580000000000e-06;1850,2.99930000000000e-06;1855,2.83960000000000e-07;1860,1.11510000000000e-05;1865,1.69820000000000e-05;1870,2.66620000000000e-10;1875,4.51300000000000e-10;1880,7.75050000000000e-05;1885,4.38900000000000e-05;1890,0.000223330000000000;1895,0.000129470000000000;1900,8.62210000000000e-07;1905,5.66670000000000e-07;1910,2.30450000000000e-05;1915,1.99470000000000e-05;1920,0.000450690000000000;1925,0.000936150000000000;1930,0.000552420000000000;1935,0.00359350000000000;1940,0.00328210000000000;1945,0.0108630000000000;1950,0.0167270000000000;1955,0.0100360000000000;1960,0.0219060000000000;1965,0.0285630000000000;1970,0.0488470000000000;1975,0.0678570000000000;1980,0.0755120000000000;1985,0.0830630000000000;1990,0.0856130000000000;1995,0.0811900000000000;2000,0.0381560000000000;2005,0.0150010000000000;2010,0.0397480000000000;2015,0.0266480000000000;2020,0.0449810000000000;2025,0.0740100000000000;2030,0.0848560000000000;2035,0.0963860000000000;2040,0.0897810000000000;2045,0.0910740000000000;2050,0.0679270000000000;2055,0.0549060000000000;2060,0.0691930000000000;2065,0.0618750000000000;2070,0.0656760000000000;2075,0.0774430000000000;2080,0.0868120000000000;2085,0.0851020000000000;2090,0.0891000000000000;2095,0.0897470000000000;2100,0.0861330000000000;2105,0.0931530000000000;2110,0.0896540000000000;2115,0.0916730000000000;2120,0.0875880000000000;2125,0.0886320000000000;2130,0.0897740000000000;2135,0.0900440000000000;2140,0.0907670000000000;2145,0.0894860000000000;2150,0.0846390000000000;2155,0.0848400000000000;2160,0.0841700000000000;2165,0.0763100000000000;2170,0.0819960000000000;2175,0.0804480000000000;2180,0.0818080000000000;2185,0.0745500000000000;2190,0.0790680000000000;2195,0.0789920000000000;2200,0.0712020000000000;2205,0.0740100000000000;2210,0.0793150000000000;2215,0.0762730000000000;2220,0.0777300000000000;2225,0.0754530000000000;2230,0.0757730000000000;2235,0.0742990000000000;2240,0.0731180000000000;2245,0.0708380000000000;2250,0.0719370000000000;2255,0.0676900000000000;2260,0.0669290000000000;2265,0.0681370000000000;2270,0.0648670000000000;2275,0.0640210000000000;2280,0.0662880000000000;2285,0.0630800000000000;2290,0.0632200000000000;2295,0.0612650000000000;2300,0.0588240000000000;2305,0.0591710000000000;2310,0.0638700000000000;2315,0.0581410000000000;2320,0.0520310000000000;2325,0.0562150000000000;2330,0.0568240000000000;2335,0.0579670000000000;2340,0.0458360000000000;2345,0.0514000000000000;2350,0.0415360000000000;2355,0.0474730000000000;2360,0.0502370000000000;2365,0.0494090000000000;2370,0.0308170000000000;2375,0.0441470000000000;2380,0.0425520000000000;2385,0.0308260000000000;2390,0.0371090000000000;2395,0.0405940000000000;2400,0.0441500000000000;2405,0.0335990000000000;2410,0.0338130000000000;2415,0.0273000000000000;2420,0.0265900000000000;2425,0.0330780000000000;2430,0.0450990000000000;2435,0.0148780000000000;2440,0.0432490000000000;2445,0.0207980000000000;2450,0.0136110000000000;2455,0.0248530000000000;2460,0.0333630000000000;2465,0.0241480000000000;2470,0.0167270000000000;2475,0.0164550000000000;2480,0.00803950000000000;2485,0.00561020000000000;2490,0.00351130000000000;2495,0.00287720000000000;2500,0.00706420000000000;2505,0.00151910000000000;2510,0.00221630000000000;2515,0.000518800000000000;2520,0.000370540000000000;2525,4.13930000000000e-05;2530,6.35930000000000e-07;2535,1.75020000000000e-07;2540,3.77160000000000e-07;2545,5.37580000000000e-11;2550,2.82220000000000e-13;2555,1.04350000000000e-09;2560,3.10200000000000e-11;2565,1.59550000000000e-14;2570,1.52580000000000e-18;2575,1.07860000000000e-27;2580,3.82140000000000e-22;2585,1.71940000000000e-34;2590,5.47930000000000e-31;2595,2.28380000000000e-33;2600,4.49120000000000e-28;2605,5.80530000000000e-35;2610,5.94470000000000e-34;2615,1.11960000000000e-37;2620,5.65050000000000e-29;2625,3.86870000000000e-28;2630,2.80260000000000e-45;2635,3.90270000000000e-16;2640,1.17500000000000e-16;2645,8.99880000000000e-19;2650,1.42950000000000e-19;2655,1.31330000000000e-27;2660,2.60680000000000e-25;2665,1.11230000000000e-37;2670,0;2675,0;2680,0;2685,0;2690,1.02260000000000e-29;2695,7.12840000000000e-33;2700,0;2705,2.93150000000000e-42;2710,1.12500000000000e-35;2715,3.85570000000000e-26;2720,5.60520000000000e-45;2725,7.29350000000000e-22;2730,6.07340000000000e-19;2735,5.48880000000000e-21;2740,2.33140000000000e-27;2745,1.31460000000000e-23;2750,1.66480000000000e-28;2755,6.72620000000000e-44;2760,0;2765,2.67770000000000e-27;2770,8.37910000000000e-24;2775,3.99900000000000e-38;2780,4.80670000000000e-34;2785,3.88660000000000e-27;2790,1.21700000000000e-16;2795,3.62050000000000e-16;2800,1.64840000000000e-12;2805,6.74780000000000e-14;2810,4.02330000000000e-10;2815,2.86850000000000e-10;2820,2.05480000000000e-11;2825,1.76050000000000e-07;2830,3.90080000000000e-06;2835,2.12760000000000e-10;2840,1.96090000000000e-07;2845,4.05750000000000e-05;2850,1.15660000000000e-06;2855,4.48670000000000e-07;2860,2.53560000000000e-05;2865,0.000167630000000000;2870,6.31290000000000e-06;2875,0.000391700000000000;2880,0.000247240000000000;2885,0.000453320000000000;2890,0.000186230000000000;2895,0.00266430000000000;2900,0.000811520000000000;2905,0.000110960000000000;2910,0.00272200000000000;2915,0.00125810000000000;2920,0.00289480000000000;2925,0.00108350000000000;2930,0.00588580000000000;2935,0.00649030000000000;2940,0.00162730000000000;2945,0.00144890000000000;2950,0.00522760000000000;2955,0.00233610000000000;2960,0.00459710000000000;2965,0.00743790000000000;2970,0.000352330000000000;2975,0.000854290000000000;2980,0.00133810000000000;2985,0.00696280000000000;2990,0.0102800000000000;2995,0.00427550000000000;3000,0.00784720000000000;3005,0.00289060000000000;3010,0.00684790000000000;3015,0.00555510000000000;3020,0.000633690000000000;3025,0.00750310000000000;3030,0.00607530000000000;3035,0.00249860000000000;3040,0.00202420000000000;3045,0.00420900000000000;3050,0.00103210000000000;3055,0.000289470000000000;3060,0.00630120000000000;3065,0.00291130000000000;3070,0.00174920000000000;3075,0.00602210000000000;3080,0.00362240000000000;3085,0.00176710000000000;3090,0.00238050000000000;3095,0.000655100000000000;3100,0.00440100000000000;3105,0.000921550000000000;3110,0.000845690000000000;3115,0.00226770000000000;3120,0.00981970000000000;3125,0.00302890000000000;3130,0.00576140000000000;3135,0.0114460000000000;3140,0.00332410000000000;3145,0.00325170000000000;3150,0.00667440000000000;3155,0.00563660000000000;3160,0.00923200000000000;3165,0.0140170000000000;3170,0.0125160000000000;3175,0.00923020000000000;3180,0.0106210000000000;3185,0.00808230000000000;3190,0.00423880000000000;3195,0.00269270000000000;3200,0.000438430000000000;3205,0.000309730000000000;3210,0.000136340000000000;3215,0.000497520000000000;3220,0.00160890000000000;3225,0.000198750000000000;3230,0.000340800000000000;3235,0.00729400000000000;3240,0.00374640000000000;3245,0.000734090000000000;3250,0.00260670000000000;3255,0.00993780000000000;3260,0.00122480000000000;3265,0.00244650000000000;3270,0.00121860000000000;3275,0.00592650000000000;3280,0.00286440000000000;3285,0.0111280000000000;3290,0.00875710000000000;3295,0.00122340000000000;3300,0.00177940000000000;3305,0.00394160000000000;3310,0.00392350000000000;3315,1.61330000000000e-05;3320,5.99870000000000e-05;3325,0.00351870000000000;3330,0.00466160000000000;3335,0.00906940000000000;3340,0.00346020000000000;3345,0.00354080000000000;3350,0.00802770000000000;3355,0.00363080000000000;3360,0.00524020000000000;3365,0.00719070000000000;3370,0.00393890000000000;3375,0.00845600000000000;3380,0.00511150000000000;3385,0.00748960000000000;3390,0.00985520000000000;3395,0.00954650000000000;3400,0.0125090000000000;3405,0.00445940000000000;3410,0.00708020000000000;3415,0.00727740000000000;3420,0.0131650000000000;3425,0.0100060000000000;3430,0.00868920000000000;3435,0.0115530000000000;3440,0.00803480000000000;3445,0.0113180000000000;3450,0.0111530000000000;3455,0.00830890000000000;3460,0.0125300000000000;3465,0.00981790000000000;3470,0.0122640000000000;3475,0.0109430000000000;3480,0.0112240000000000;3485,0.0120940000000000;3490,0.0104190000000000;3495,0.0122650000000000;3500,0.0119170000000000;3505,0.0118090000000000;3510,0.0119630000000000;3515,0.0114940000000000;3520,0.0121220000000000;3525,0.0114280000000000;3530,0.0111270000000000;3535,0.00945560000000000;3540,0.00903100000000000;3545,0.00954320000000000;3550,0.0105380000000000;3555,0.00905810000000000;3560,0.0107950000000000;3565,0.0108510000000000;3570,0.00833760000000000;3575,0.00864440000000000;3580,0.0101870000000000;3585,0.00916710000000000;3590,0.00945230000000000;3595,0.00967000000000000;3600,0.0102620000000000;3605,0.0103590000000000;3610,0.00947870000000000;3615,0.00947260000000000;3620,0.0116140000000000;3625,0.0102390000000000;3630,0.00995500000000000;3635,0.0102990000000000;3640,0.0114800000000000;3645,0.0105990000000000;3650,0.0101230000000000;3655,0.0109780000000000;3660,0.0109140000000000;3665,0.0102530000000000;3670,0.00790030000000000;3675,0.00482860000000000;3680,0.00833120000000000;3685,0.00943800000000000;3690,0.00969220000000000;3695,0.0101320000000000;3700,0.0108780000000000;3705,0.0107700000000000;3710,0.00936400000000000;3715,0.00922540000000000;3720,0.0103760000000000;3725,0.0106980000000000;3730,0.00927070000000000;3735,0.00858370000000000;3740,0.00884940000000000;3745,0.0103310000000000;3750,0.00929030000000000;3755,0.00899180000000000;3760,0.00886330000000000;3765,0.00855020000000000;3770,0.00912430000000000;3775,0.00905210000000000;3780,0.00957460000000000;3785,0.00881230000000000;3790,0.00775640000000000;3795,0.00886920000000000;3800,0.00985920000000000;3805,0.00930490000000000;3810,0.00824510000000000;3815,0.00775690000000000;3820,0.00965500000000000;3825,0.00950560000000000;3830,0.00959250000000000;3835,0.00769160000000000;3840,0.00897560000000000;3845,0.00878010000000000;3850,0.00882740000000000;3855,0.00850850000000000;3860,0.00799400000000000;3865,0.00809890000000000;3870,0.00736040000000000;3875,0.00676200000000000;3880,0.00653400000000000;3885,0.00677170000000000;3890,0.00688180000000000;3895,0.00747600000000000;3900,0.00792540000000000;3905,0.00792690000000000;3910,0.00713530000000000;3915,0.00698680000000000;3920,0.00694660000000000;3925,0.00685200000000000;3930,0.00705020000000000;3935,0.00735410000000000;3940,0.00740270000000000;3945,0.00754120000000000;3950,0.00762770000000000;3955,0.00771990000000000;3960,0.00774820000000000;3965,0.00780570000000000;3970,0.00768060000000000;3975,0.00750970000000000;3980,0.00738720000000000;3985,0.00743270000000000;3990,0.00737230000000000;3995,0.00721000000000000;4000,0.00710430000000000];
Ks = 1;
Eg = linspace(0.6,2,3);
T = 298.15; %Temperature (K)
pM = 1;
base = 0;

XYZ = colorspace('RGB->XYZ',[0,1,0]); % Target color in RGB coordinates, converted to XYZ
Clim = 0.005; %Largest allowed error of colour. Used only in case of two Gaussian peaks

[Result1G] = Eff_1Gaussian(Sp,Ks,Eg,T,pM,base,XYZ); %Color generated using one Gaussian peak

%% ----------------- TMM Main -------------------

lambda=300:1500; % Wavelengths over which field patterns are calculated
stepsize = 0.5;   % The electric field is calculated at a latice of points (nm)
                % in the device cross section seperated by this distance

base=Result1G.base_k_Yk_c_pMLim(1);
peak=Result1G.base_k_Yk_c_pMLim(2);
center=Result1G.base_k_Yk_c_pMLim(3);
width=Result1G.base_k_Yk_c_pMLim(4);

% 1 Gaussian spectrum generation
spectrum = base+ peak*exp(-((lambda-center)/width).^2);

Rgoal=spectrum;

layers = {'Air' 'SiO2' 'TiO2' 'Silica'}; % Names of layers of materials starting from side light is incident from, 2-layer

Linit = [100,100]; % Initial values

Lbnd_bot = [0,0];
Lbnd_up = [300,300];

options = optimset('Display','iter','MaxIter',5000,'MaxFunEvals',5000,'TolFun',1e-9,'TolX',1e-9);

figure
Lopt = fminsearchbnd(@(L) TMM_Optimizer(layers,abs(L),lambda,stepsize,Rgoal),Linit,Lbnd_bot,Lbnd_up,options);
legend('Reflectance','Target Reflectance','Transmittance')
legend boxoff
% Lopt = fminsearch(@(L) tmm_optimizer(layers,abs(L),lambda,stepsize,Rgoal),Linit,options);

